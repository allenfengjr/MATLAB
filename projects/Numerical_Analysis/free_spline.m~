%统一下标,全部从1开始,x(1,1)是x[0],这里的n
function abcd =free_spline(n,x,a)
abcd = zeros(4,n);
h = zeros(1,n);
alpha = zeros(1,n-1);
for i=1:n-1
    h(1,i) = x(1,i+1) - x(1,i);
end
for i=2:n-1
    alpha(1,i) = 3*(a(1,i+1)-a(1,i))/h(1,i) - 3*(a(1,i)-a(1,i-1))/h(1,i-1);
end
l = zeros(1,n);l(1,1)=1;
u = zeros(1,n);
z = zeros(1,n);
for i=2:n-1
    l(1,i) = 2*(x(1,i+1)-x(1,i-1)) - h(1,i-1)*u(1,i-1);
    u(1,i) = h(1,i) /l(1,i);
    z(1,i) = (alpha(1,i)- h(1,i-1)*z(1,i-1)) / l(1,i);
end
b = zeros(1,n);
c = zeros(1,n);
d = zeros(1,n);

for j=n-1:-1:1
    c(1,j) = z(1,j)-u(1,j)*c(1,j+1);
    b(1,j) = (a(i,j+1)-a(1,j))/h(1,j) - h(1,j)*(c(1,j+1)+2*c(1,j))/3;
    d(1,j) = (c(1,j+1)-c(1,j))/(3*h(1,j));
end
abcd = [a;b;c;d];